<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[PT] Heat - Introdução - GitOps</title>
<meta name="description" content="Originally published at Churrops on DevOps on December 20, 2017.">


  <meta name="author" content="Jose Castillo Lema">
  
  <meta property="article:author" content="Jose Castillo Lema">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="GitOps">
<meta property="og:title" content="[PT] Heat - Introdução">
<meta property="og:url" content="https://josecastillolema.github.io/heat-introducao/">


  <meta property="og:description" content="Originally published at Churrops on DevOps on December 20, 2017.">



  <meta property="og:image" content="https://josecastillolema.github.io/assets/images/favicon_io/android-chrome-512x512.png">





  <meta property="article:published_time" content="2017-12-20T00:00:00-06:00">



  <meta property="article:modified_time" content="2017-10-28T00:00:00-05:00">




<link rel="canonical" href="https://josecastillolema.github.io/heat-introducao/">







  <meta name="google-site-verification" content="googled48a6d8a28aaa375.html" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="GitOps Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="shortcut icon" type="image/png" href="/assets/images/favicon.ico">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/favicon_io/android-chrome-192x192.png" alt="GitOps"></a>
        
        <a class="site-title" href="/">
          GitOps
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/series/"
                
                
              >series</a>
            </li><li class="masthead__menu-item">
              <a
                href="/classes/"
                
                
              >classes</a>
            </li><li class="masthead__menu-item">
              <a
                href="/talks/"
                
                
              >talks</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >about</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <script lang="javascript" src="/assets/js/vanilla-back-to-top.min.js"></script>
    <script>addBackToTop({
      backgroundColor: '#6F777D',
      textColor: '#fff'
    })</script>

    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://josecastillolema.github.io/">
        <img src="/assets/images/me.jpg" alt="Jose Castillo Lema" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://josecastillolema.github.io/" itemprop="url">Jose Castillo Lema</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Software Engineer @ <strong>RedHat</strong></p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Santiago, Spain</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/josecastillolema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/jose-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://www.youracclaim.com/users/jose-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-angle-double-up" aria-hidden="true"></i><span class="label">Acclaim</span></a></li>
          
        
          
            <li><a href="https://stackoverflow.com/users/4288758/jos%c3%a9-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">StackOverflow</span></a></li>
          
        
          
            <li><a href="https://www.researchgate.net/profile/Jose_Castillo-Lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-researchgate" aria-hidden="true"></i><span class="label">ResearchGate</span></a></li>
          
        
          
            <li><a href="https://scholar.google.com.br/citations?user=_xNpHiwAAAAJ" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-google" aria-hidden="true"></i><span class="label">GoogleScholar</span></a></li>
          
        
          
            <li><a href="https://www.opennetworking.org/ambassadors/jose-castillo-lema/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-battle-net" aria-hidden="true"></i><span class="label">ONF</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/channel/UCm5egt_lHxJX-VQdkLPszog/playlists" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube-square" aria-hidden="true"></i><span class="label">YouTube</span></a></li>
          
        
          
            <li><a href="https://josecastillolema.github.io/feed.xml" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i><span class="label">RSS</span></a></li>
          
        
          
            <li><a href="mailto:josecastillolema@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[PT] Heat - Introdução">
    <meta itemprop="description" content="  Originally published at Churrops on DevOps on December 20, 2017.">
    <meta itemprop="datePublished" content="2017-12-20T00:00:00-06:00">
    <meta itemprop="dateModified" content="2017-10-28T00:00:00-05:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://josecastillolema.github.io/heat-introducao/" itemprop="url">[PT] Heat - Introdução
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          12 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#pré-requisitos">Pré requisitos</a></li><li><a href="#descrição-do-template">Descrição do template</a></li><li><a href="#execução-do-template">Execução do template</a><ul><li><a href="#via-horizon">Via Horizon</a></li><li><a href="#via-cli">Via CLI</a></li><li><a href="#via-api-rest">Via API REST</a></li></ul></li><li><a href="#resultado-da-execução">Resultado da execução</a></li><li><a href="#conclusão">Conclusão</a></li></ul>
            </nav>
          </aside>
        
        <blockquote>
  <p>Originally published at <a href="https://churrops.io/2017/12/20/heat-introducao/"><strong>Churrops on DevOps</strong></a> on December 20, 2017.</p>
</blockquote>

<p>Olá pessoal, vamos começar uma série de artigos sobre Heat, o “terraform” nativo do OpenStack, ou para quem vem do mundo da AWS, o CloudFormation do OpenStack (inclusive parcialmente compatível). Neste primeiro artigo introdutório vamos aprender a criar as nossas próprias pilhas (ou <em>stacks</em>) e recriar a instância do servidor web que criamos no <a href="/terraformando-openstack">post passado</a> usando o Terraform.</p>

<p>O objetivo principal de Heat é criar um serviço para gerenciar todo o ciclo de vida de infra e aplicativos dentro do OpenStack. Ele implementa um mecanismo de orquestração com base em <em>templates</em> na forma de arquivos de texto (em formato <code class="language-plaintext highlighter-rouge">.yaml</code>) que podem ser tratados como código. O formato dos <code class="language-plaintext highlighter-rouge">templates</code> está evoluindo a cada versão do OpenStack, mas o Heat se esforça para fornecer compatibilidade com o formato do modelo AWS CloudFormation, de modo que muitos modelos CloudFormation existentes podem ser iniciados no OpenStack (inclusive permitindo, por exemplo, escalar do OpenStack para dentro da AWS). Para quem tiver interesse, existe também um esforço da comunidade para suportar templates TOSCA, chamado <a href="https://wiki.openstack.org/wiki/Heat-Translator">Heat Translator</a>.</p>

<p>O Heat fornece uma API REST nativa do OpenStack e uma API de consulta compatível com o CloudFormation, além de interface gráfica via Horizon (o <em>dashboard</em> de OpenStack) e um cliente para a linha de comandos (antigamente <code class="language-plaintext highlighter-rouge">heat</code>, nas versões mais novas de OpenStack foi integrado no próprio comando <code class="language-plaintext highlighter-rouge">openstack</code>).</p>

<p>Uma característica importante do Heat é que ele gerencia todo o ciclo de vida do aplicativo, e não só a criação. Quando precisar alterar a infra, simplesmente modifique o modelo e use o Heat para atualizar sua pilha existente. Heat sabe como fazer as mudanças necessárias. Ele irá excluir todos os recursos quando você terminar o aplicativo também (tipo <code class="language-plaintext highlighter-rouge">terraform destroy</code>).</p>

<p>Os recursos de infra que podem ser descritos incluem: instâncias, IPs públicos, volumes, grupos de segurança, usuários, roteadores, etc. Os modelos também podem especificar as relações entre recursos (por exemplo, este volume está conectado a este servidor). Isso permite que o Heat invoque as APIs do OpenStack para criar toda sua infra virtual na ordem correta para iniciar completamente sua aplicação.</p>

<p>O Heat também se integra com o Ceilometer, o módulo de telemetria do OpenStack, permitindo definir políticas de uso de <em>autoscaling</em> em função do uso dos recursos (chegaremos lá nos próximos artigos!).</p>

<p>O Heat gerencia principalmente a infra virtual, mas os modelos se integram bem com ferramentas de gerenciamento de configuração de <em>software</em>, como Puppet e Chef, e a equipe do Heat está trabalhando para fornecer uma integração ainda melhor entre infraestrutura e <em>software</em>. Existem várias opções para configurar o software que é executado nos servidores do <em>stack</em>:</p>
<ul>
  <li>Criar uma imagem personalizada (de preferência usando <a href="https://git.openstack.org/cgit/openstack/diskimage-builder"><strong>diskimager-builder</strong></a>)</li>
  <li>Via <a href="https://cloud-init.io/"><strong>cloud-init</strong></a>, um script que é executado durante o primeiro boot. Esta será a forma que usaremos ao longo dos artigos.</li>
  <li>Um recurso do heat, de tipo <strong><em>software deployment</em></strong>.</li>
</ul>

<p>Sem mais, vamos criar o nosso primeiro <em>stack</em> e recriar o nosso servidor web.</p>

<h2 id="pré-requisitos">Pré requisitos</h2>

<ul>
  <li>Uma conta em alguma nuvem OpenStack, não necessariamente <code class="language-plaintext highlighter-rouge">admin</code></li>
  <li>Quota suficiente na nossa conta para instanciar os recursos solicitados</li>
</ul>

<p>No repositório <a href="https://github.com/josecastillolema/churrops.git">https://github.com/josecastillolema/churrops.git</a> podem fazer <em>download</em> do arquivo heat.yaml, o <em>template</em> que usaremos durante este artigo.</p>

<h2 id="descrição-do-template">Descrição do <em>template</em></h2>
<p>As duas primeras linhas mostram a versão em uso do formato do template e uma descrição do conteúdo do mesmo:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">heat_template_version</span><span class="pi">:</span> <span class="s">2016-04-08</span>
<span class="na">description</span><span class="pi">:</span> <span class="s">Servidor web para churrops!</span>
</code></pre></div></div>

<p>A seguir, o primeiro bloco do <em>template</em>, <code class="language-plaintext highlighter-rouge">parameters</code>, define uma série de parâmetros que serão usados durante o <em>deployment</em> da infra (de forma análoga ao bloco <code class="language-plaintext highlighter-rouge">variable</code> no caso do Terraform). Podemos definir neste bloco imagem, <em>flavor</em>, redes, chaves para acessar aos nossos servidores, etc. Para cada parâmetro definido podemos adicionar uma descrição e um valor padrão.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">parameters</span><span class="pi">:</span>
  <span class="na">flavor</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Flavor para o servidor web</span>
    <span class="na">constraints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">custom_constraint</span><span class="pi">:</span> <span class="s">nova.flavor</span>
    <span class="na">default</span><span class="pi">:</span> <span class="s">g1.micro</span>
  <span class="na">image</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Imagem para o servidor web</span>
    <span class="na">constraints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">custom_constraint</span><span class="pi">:</span> <span class="s">glance.image</span>
    <span class="na">default</span><span class="pi">:</span> <span class="s">linux-ubuntu-16-64b-base</span>
  <span class="na">private_network</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Rede interna</span>
    <span class="na">constraints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">custom_constraint</span><span class="pi">:</span> <span class="s">neutron.network</span>
    <span class="na">default</span><span class="pi">:</span> <span class="s">net-int1</span>
  <span class="na">private_ip</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">IP interna do servidor</span>
    <span class="na">default</span><span class="pi">:</span> <span class="s">10.0.0.200</span>
  <span class="na">key_name</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">A chave ssh para acessar a nossa vm</span>
    <span class="na">constraints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">custom_constraint</span><span class="pi">:</span> <span class="s">nova.keypair</span>
    <span class="na">default</span><span class="pi">:</span> <span class="s">devel</span>
  <span class="na">public_network</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Rede publica</span>
    <span class="na">constraints</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">custom_constraint</span><span class="pi">:</span> <span class="s">neutron.network</span>
  <span class="na">texto</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Texto exibido no site</span>
    <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Churrops</span><span class="nv"> </span><span class="s">rules"</span>
</code></pre></div></div>
<p>No segundo bloco, <code class="language-plaintext highlighter-rouge">resources</code>, é a onde vamos definir os recursos da nossa infra. Neste caso vamos definir o nosso servidor web. Podem consultar uma lista de todos os recursos disponíveis <a href="https://docs.openstack.org/heat/pike/template_guide/openstack.html">aqui</a>. O servidor web é configurado via <strong>cloud-init</strong> no primeiro <em>boot</em>. Vejam que é possível passar parâmetros para os recursos, como neste caso o parâmetro <code class="language-plaintext highlighter-rouge">TEXTO</code>.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">resources</span><span class="pi">:</span>
  <span class="na">sec_group</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">OS::Neutron::SecurityGroup</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">rules</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">remote_ip_prefix</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
        <span class="na">protocol</span><span class="pi">:</span> <span class="s">icmp</span>
      <span class="pi">-</span> <span class="na">remote_ip_prefix</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
        <span class="na">protocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">port_range_min</span><span class="pi">:</span> <span class="m">80</span>
        <span class="na">port_range_max</span><span class="pi">:</span> <span class="m">80</span>
      <span class="pi">-</span> <span class="na">remote_ip_prefix</span><span class="pi">:</span> <span class="s">0.0.0.0/0</span>
        <span class="na">protocol</span><span class="pi">:</span> <span class="s">tcp</span>
        <span class="na">port_range_min</span><span class="pi">:</span> <span class="m">22</span>
        <span class="na">port_range_max</span><span class="pi">:</span> <span class="s">22</span> 

  <span class="na">serverweb_port</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">OS::Neutron::Port</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">network_id</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">private_network</span> <span class="pi">}</span>
      <span class="na">security_groups</span><span class="pi">:</span> <span class="pi">[{</span> <span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">sec_group</span> <span class="pi">}]</span>

  <span class="na">serverweb</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">OS::Nova::Server</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">image</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">image</span> <span class="pi">}</span>
      <span class="na">flavor</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">flavor</span> <span class="pi">}</span>
      <span class="na">networks</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">port</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">serverweb_port</span> <span class="pi">}</span>
      <span class="na">user_data_format</span><span class="pi">:</span> <span class="s">RAW</span>
      <span class="na">key_name</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">key_name</span> <span class="pi">}</span>
      <span class="na">user_data</span><span class="pi">:</span>
        <span class="na">str_replace</span><span class="pi">:</span>
          <span class="na">template</span><span class="pi">:</span> <span class="pi">|</span>
            <span class="s">#!/bin/bash</span>
            <span class="s">sudo -i</span>
            <span class="s">apt-get update</span>
            <span class="s">apt-get install -y apache2</span>
            <span class="s">cat &lt; /var/www/html/index.html</span>
            <span class="s">Churrops!!! o/</span>
            <span class="s">hostname: $(hostname)</span>
            <span class="s">parametro: TEXTO</span>
            <span class="s">EOF</span>
          <span class="na">params</span><span class="pi">:</span>
            <span class="na">TEXTO</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">texto</span> <span class="pi">}</span>

  <span class="na">floating_ip</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">OS::Neutron::FloatingIP</span>
    <span class="na">properties</span><span class="pi">:</span>
      <span class="na">floating_network</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_param</span><span class="pi">:</span> <span class="nv">public_network</span> <span class="pi">}</span>
      <span class="na">port_id</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_resource</span><span class="pi">:</span> <span class="nv">serverweb_port</span> <span class="pi">}</span>
</code></pre></div></div>
<p>O terceiro e ultimo bloco, <code class="language-plaintext highlighter-rouge">outputs</code>, tem uma função análoga ao arquivo <code class="language-plaintext highlighter-rouge">output.tf</code> do Terraform. Ele define uma saída que será mostrada ao usuário ao terminar a criação da infra.</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">outputs</span><span class="pi">:</span>
  <span class="na">lburl</span><span class="pi">:</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">URL do servidor web</span>
    <span class="na">value</span><span class="pi">:</span>
      <span class="na">str_replace</span><span class="pi">:</span>
        <span class="na">template</span><span class="pi">:</span> <span class="s">http://IP_ADDRESS</span>
        <span class="na">params</span><span class="pi">:</span>
          <span class="na">IP_ADDRESS</span><span class="pi">:</span> <span class="pi">{</span> <span class="nv">get_attr</span><span class="pi">:</span> <span class="pi">[</span> <span class="nv">floating_ip</span><span class="pi">,</span> <span class="nv">floating_ip_address</span> <span class="pi">]</span> <span class="pi">}</span>
    <span class="na">description</span><span class="pi">:</span> <span class="pi">&gt;</span>
      <span class="s">Esta URL e a URL "externa" que pode ser usada para acessar o servidor WEB.</span>
</code></pre></div></div>

<h2 id="execução-do-template">Execução do <em>template</em></h2>

<h3 id="via-horizon">Via Horizon</h3>
<p>Primeiro, na aba <code class="language-plaintext highlighter-rouge">Orquestration - Stacks</code> criamos o nosso <em>stack</em> e setamos os parâmetros opcionais que foram definidos no template.
<img src="/assets/images/posts/2017-12-20-heat-introducao/01.png" alt="" /></p>

<p>A continuação podemos ver a topologia diversos recursos sendo criados (os recursos em verde já estão disponíveis).
<img src="/assets/images/posts/2017-12-20-heat-introducao/02.png" alt="" /></p>

<p>Um <em>overview</em> da nossa pilha, com o <em>output</em> que definimos no <em>template</em>.
<img src="/assets/images/posts/2017-12-20-heat-introducao/03.png" alt="" /></p>

<p>Os recursos que estão sendo criados.
<img src="/assets/images/posts/2017-12-20-heat-introducao/04.png" alt="" /></p>

<p>E por último todos os eventos relacionados com esses recursos (criação, atualização, modificação, deleção, etc.).
<img src="/assets/images/posts/2017-12-20-heat-introducao/05.png" alt="" /></p>

<h3 id="via-cli">Via CLI</h3>
<ul>
  <li>Criação:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openstack stack create churrops-stack -t heat.yaml
openstack stack create churrops-stack -t heat.yaml
</code></pre></div>    </div>
  </li>
  <li>Para acompanhar a criação:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>watch openstack stack event list churrops-stack

</code></pre></div>    </div>
  </li>
</ul>

<h3 id="via-api-rest">Via API REST</h3>
<p>Como falamos na introdução, o Heat fornece uma API REST nativa do OpenStack e uma API de consulta compatível com o CloudFormation. Neste caso usaremos a API REST nativa.</p>

<p><img src="/assets/images/posts/2017-12-20-heat-introducao/06.png" alt="" /></p>

<h2 id="resultado-da-execução">Resultado da execução</h2>

<p>Independentemente do método escolhido (Horizon, CLI ou API REST), uma vez que o <em>stack</em> transicione ao estado <code class="language-plaintext highlighter-rouge">created</code> (não deveria demorar muito mais de 2 minutos) poderemos ver a infra instanciada.
<img src="/assets/images/posts/2017-12-20-heat-introducao/07.png" alt="" /></p>

<p>Em alguns minutos (enquanto <strong>cloud-init</strong> instala e configura o servidor web Apache), poderemos acessar ao nosso servidor pela IP pública.
<img src="/assets/images/posts/2017-12-20-heat-introducao/07.png" alt="" /></p>

<h2 id="conclusão">Conclusão</h2>
<p>Neste artigo introduzimos o Heat, o orquestrador do OpenStack. Vimos como mantém todas as funcionalidades de outros IaCs, como Terraform, mas é integrado de uma forma mais nativa no OpenStack e podemos accesá-lo via <em>dashboard</em>	, linha de comandos ou API REST (compatível com a AWS CloudFormation).</p>

<p>Nos próximos artigos veremos como criar via Heat um balanceador de carga em alta disponibilidade usando <code class="language-plaintext highlighter-rouge">haproxy</code> e VRRP.</p>

<p>Um abraço!</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#iac" class="page__taxonomy-item p-category" rel="tag">iac</a><span class="sep">, </span>
    
      <a href="/tags/#openstack" class="page__taxonomy-item p-category" rel="tag">openstack</a><span class="sep">, </span>
    
      <a href="/tags/#pt" class="page__taxonomy-item p-category" rel="tag">pt</a><span class="sep">, </span>
    
      <a href="/tags/#redhat" class="page__taxonomy-item p-category" rel="tag">redhat</a><span class="sep">, </span>
    
      <a href="/tags/#series" class="page__taxonomy-item p-category" rel="tag">series</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2017-10-28">October 28, 2017</time></p>

      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=%5BPT%5D+Heat+-+Introdu%C3%A7%C3%A3o%20https%3A%2F%2Fjosecastillolema.github.io%2Fheat-introducao%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fjosecastillolema.github.io%2Fheat-introducao%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://josecastillolema.github.io/heat-introducao/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/terraformando-openstack/" class="pagination--pager" title="[PT] Terraform – IaC – Terraformando no OpenStack
">Previous</a>
    
    
      <a href="/hntd-11/" class="pagination--pager" title="HCNA-HNTD Training - 11th edition
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/dnfa6/" rel="permalink">Management orchestrator for a Content-Centric Network in a 6G network
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Management orchestrator for a Content-Centric Network in a 6G network

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/rh-summit24/" rel="permalink">Red Hat Summit 2024
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/lf-nephio/" rel="permalink">Introduction to Nephio (LSF179)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/industriosa-ocaml/" rel="permalink">Descubre el poder de la programación funcional a través de OCaml
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/josecastillolema" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/jose-castillo-lema" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://stackoverflow.com/users/4288758/jos%c3%a9-castillo-lema" rel="nofollow noopener noreferrer"><i class="fab fa-stack-overflow" aria-hidden="true"></i> Stack Overflow</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="https://josecastillolema.github.io">GitOps</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-169326084-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://josecastillolema.github.io/heat-introducao/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/heat-introducao"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-josecastillolema-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
