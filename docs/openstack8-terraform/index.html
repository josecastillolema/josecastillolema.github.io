<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>OpenStack series VIII: Terraform - GitOps</title>
<meta name="description" content="Serie de artigos sobre OpenStack.">


  <meta name="author" content="Jose Castillo Lema">
  
  <meta property="article:author" content="Jose Castillo Lema">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="GitOps">
<meta property="og:title" content="OpenStack series VIII: Terraform">
<meta property="og:url" content="https://josecastillolema.github.io/openstack8-terraform/">


  <meta property="og:description" content="Serie de artigos sobre OpenStack.">



  <meta property="og:image" content="https://josecastillolema.github.io/assets/images/favicon_io/android-chrome-512x512.png">





  <meta property="article:published_time" content="2018-05-04T00:00:00-05:00">



  <meta property="article:modified_time" content="2018-05-04T00:00:00-05:00">




<link rel="canonical" href="https://josecastillolema.github.io/openstack8-terraform/">







  <meta name="google-site-verification" content="googled48a6d8a28aaa375.html">






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="GitOps Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="shortcut icon" type="image/png" href="/assets/images/favicon.ico">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/favicon_io/android-chrome-192x192.png" alt="GitOps"></a>
        
        <a class="site-title" href="/">
          GitOps
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/series/">series</a>
            </li>
<li class="masthead__menu-item">
              <a href="/classes/">classes</a>
            </li>
<li class="masthead__menu-item">
              <a href="/talks/">talks</a>
            </li>
<li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li>
<li class="masthead__menu-item">
              <a href="/about/">about</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <script lang="javascript" src="/assets/js/vanilla-back-to-top.min.js"></script>
    <script>addBackToTop({
      backgroundColor: '#6F777D',
      textColor: '#fff'
    })</script>

    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://josecastillolema.github.io/">
        <img src="/assets/images/me.jpg" alt="Jose Castillo Lema" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://josecastillolema.github.io/" itemprop="url">Jose Castillo Lema</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Software Engineer @ <strong>RedHat</strong></p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Santiago, Spain</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/josecastillolema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/jose-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://www.youracclaim.com/users/jose-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-angle-double-up" aria-hidden="true"></i><span class="label">Acclaim</span></a></li>
          
        
          
            <li><a href="https://stackoverflow.com/users/4288758/jos%c3%a9-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">StackOverflow</span></a></li>
          
        
          
            <li><a href="https://www.researchgate.net/profile/Jose_Castillo-Lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-researchgate" aria-hidden="true"></i><span class="label">ResearchGate</span></a></li>
          
        
          
            <li><a href="https://scholar.google.com.br/citations?user=_xNpHiwAAAAJ" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-google" aria-hidden="true"></i><span class="label">GoogleScholar</span></a></li>
          
        
          
            <li><a href="https://www.opennetworking.org/ambassadors/jose-castillo-lema/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-battle-net" aria-hidden="true"></i><span class="label">ONF</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/channel/UCm5egt_lHxJX-VQdkLPszog/playlists" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube-square" aria-hidden="true"></i><span class="label">YouTube</span></a></li>
          
        
          
            <li><a href="https://josecastillolema.github.io/feed.xml" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i><span class="label">RSS</span></a></li>
          
        
          
            <li><a href="mailto:josecastillolema@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="OpenStack series VIII: Terraform">
    <meta itemprop="description" content="Serie de artigos sobre OpenStack.">
    <meta itemprop="datePublished" content="2018-05-04T00:00:00-05:00">
    <meta itemprop="dateModified" content="2018-05-04T00:00:00-05:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://josecastillolema.github.io/openstack8-terraform/" itemprop="url">OpenStack series VIII: Terraform
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li>
<a href="#lab-8---terraform">Lab 8 - Terraform</a><ul>
<li><a href="#openstack-provider">OpenStack Provider</a></li>
<li><a href="#instala%C3%A7%C3%A3o">Instalação</a></li>
<li><a href="#uso">Uso</a></li>
<li><a href="#clean-up">Clean-up</a></li>
</ul>
</li></ul>
            </nav>
          </aside>
        
        <p><a href="/series/#openstack">Serie de artigos</a> sobre OpenStack.</p>

<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&repo=fiap&type=watch&count=true&size=large&v=2" frameborder="0" scrolling="0" width="132" height="30" title="GitHub"></iframe>
<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&repo=fiap&type=star&count=true&size=large" frameborder="0" scrolling="0" width="130" height="30" title="GitHub"></iframe>
<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&repo=fiap&type=fork&count=true&size=large" frameborder="0" scrolling="0" width="170" height="30" title="GitHub"></iframe>

<h1 id="lab-8---terraform">Lab 8 - Terraform</h1>

<h2 id="openstack-provider">OpenStack Provider</h2>

<p>O <a href="https://www.terraform.io/">Terraform</a> é uma ferramenta para construir, alterar e controlar a infraestrutura de forma segura e eficiente. O Terraform pode gerenciar provedores de serviços existentes e populares como OpenStack, Azure, AWS, Digital Ocean, entre outras, bem como soluções internas personalizadas.</p>

<p>Os arquivos de configuração do Terraform descrevem os componentes necessários para executar um único aplicativo ou todo o <em>datacenter</em>, gerando um plano de execução que descreve o que será feito para alcançar o estado desejado e, em seguida, executá-lo para construir a infraestrutura descrita. À medida que a configuração muda, o Terraform é capaz de determinar o que mudou e criar planos de execução incrementais que podem ser aplicados.</p>

<p>A infraestrutura que o Terraform pode gerenciar inclui componentes de baixo nível, como instâncias de computação, armazenamento e redes, bem como componentes de alto nível, como entradas DNS, recursos SaaS, etc.</p>

<p>Com relação a ferramenta podemos comparar o Terraform com o CloudFormation da AWS.</p>

<h2 id="instalação">Instalação</h2>

<ol>
  <li>
    <p>Fazer o <em>download</em> da ferramenta:</p>

    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ wget https://releases.hashicorp.com/terraform/0.13.5/terraform_0.13.5_linux_amd64.zip
 --2020-10-28 12:37:26--  https://releases.hashicorp.com/terraform/0.13.5/terraform_0.13.5_linux_amd64.zip
 Resolving releases.hashicorp.com (releases.hashicorp.com)... 151.101.1.183, 151.101.65.183, 151.101.129.183, ...
 Connecting to releases.hashicorp.com (releases.hashicorp.com)|151.101.1.183|:443... connected.
 HTTP request sent, awaiting response... 200 OK
 Length: 34880173 (33M) [application/zip]
 Saving to: ‘terraform_0.13.5_linux_amd64.zip’

 terraform_0.13.5_linux_amd64.zip            100%[========================================================================================&gt;]  33.26M  32.0MB/s    in 1.0s

 2020-10-28 12:37:27 (32.0 MB/s) - ‘terraform_0.13.5_linux_amd64.zip’ saved [34880173/34880173]
</code></pre></div>    </div>
  </li>
  <li>Descomprimir o arquivo baixado:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ unzip terraform_0.13.5_linux_amd64.zip
 Archive:  terraform_0.13.5_linux_amd64.zip
   inflating: terraform
</code></pre></div>    </div>
  </li>
  <li>Movimentar o executável:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ sudo mv terraform /usr/local/bin/
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="uso">Uso</h2>

<ol>
  <li>Baixar os <em>templates</em>:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ git clone https://github.com/josecastillolema/fiap
 Cloning into 'fiap'...
 remote: Enumerating objects: 10, done.
 remote: Counting objects: 100% (10/10), done.
 remote: Compressing objects: 100% (10/10), done.
 remote: Total 3716 (delta 4), reused 0 (delta 0), pack-reused 3706
 Receiving objects: 100% (3716/3716), 44.63 MiB | 3.88 MiB/s, done.
 Resolving deltas: 100% (1862/1862), done.
 Checking connectivity... done.
    
 $ cd fiap/cld/openstack/lab08-terraform/
</code></pre></div>    </div>
  </li>
  <li>Inicializar o Terraform e o correspondente <em>provider</em> (plugin) de OpenStack:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ terraform init

 Initializing the backend...

 Initializing provider plugins...
 - Finding latest version of terraform-provider-openstack/openstack...
 - Installing terraform-provider-openstack/openstack v1.32.0...
 - Installed terraform-provider-openstack/openstack v1.32.0 (self-signed, key ID 4F80527A391BEFD2)

 Partner and community providers are signed by their developers.
 If you'd like to know more about provider signing, you can read about it here:
 https://www.terraform.io/docs/plugins/signing.html

 The following providers do not have any version constraints in configuration,
 so the latest version was installed.

 To prevent automatic upgrades to new major versions that may contain breaking
 changes, we recommend adding version constraints in a required_providers block
 in your configuration, with the constraint strings suggested below.

 * terraform-provider-openstack/openstack: version = "~&gt; 1.32.0"

 Terraform has been successfully initialized!

 You may now begin working with Terraform. Try running "terraform plan" to see
 any changes that are required for your infrastructure. All Terraform commands
 should now work.

 If you ever set or change modules or backend configuration for Terraform,
 rerun this command to reinitialize your working directory. If you forget, other
 commands will detect it and remind you to do so if necessary.
 os@ubuntu:~/fiap/cld/openstack$ terraform plan
 Refreshing Terraform state in-memory prior to plan...
 The refreshed state will be used to calculate this plan, but will not be
 persisted to local or remote state storage.


 ------------------------------------------------------------------------
</code></pre></div>    </div>
  </li>
  <li>Criar o plano:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ terraform plan
 Refreshing Terraform state in-memory prior to plan...
 The refreshed state will be used to calculate this plan, but will not be
 persisted to local or remote state storage.


 ------------------------------------------------------------------------

 An execution plan has been generated and is shown below.
 Resource actions are indicated with the following symbols:
   + create

 Terraform will perform the following actions:

   # openstack_compute_floatingip_associate_v2.asoc-ip-publica will be created
   + resource "openstack_compute_floatingip_associate_v2" "asoc-ip-publica" {
       + floating_ip = (known after apply)
       + id          = (known after apply)
       + instance_id = (known after apply)
       + region      = (known after apply)
     }

   # openstack_compute_instance_v2.web will be created
   + resource "openstack_compute_instance_v2" "web" {
       + access_ip_v4        = (known after apply)
       + access_ip_v6        = (known after apply)
       + all_metadata        = (known after apply)
       + all_tags            = (known after apply)
       + availability_zone   = "nova"
       + flavor_id           = (known after apply)
       + flavor_name         = "m.fiap"
       + force_delete        = false
       + id                  = (known after apply)
       + image_id            = (known after apply)
       + image_name          = "cirros-0.3.5-x86_64-disk"
       + name                = "web"
       + power_state         = "active"
       + region              = (known after apply)
       + security_groups     = [
           + "default",
         ]
       + stop_before_destroy = false

       + network {
           + access_network = false
           + fixed_ip_v4    = (known after apply)
           + fixed_ip_v6    = (known after apply)
           + floating_ip    = (known after apply)
           + mac            = (known after apply)
           + name           = "private"
           + port           = (known after apply)
           + uuid           = (known after apply)
         }
     }

   # openstack_networking_floatingip_v2.ip-publica will be created
   + resource "openstack_networking_floatingip_v2" "ip-publica" {
       + address    = (known after apply)
       + all_tags   = (known after apply)
       + dns_domain = (known after apply)
       + dns_name   = (known after apply)
       + fixed_ip   = (known after apply)
       + id         = (known after apply)
       + pool       = "public"
       + port_id    = (known after apply)
       + region     = (known after apply)
       + tenant_id  = (known after apply)
     }

 Plan: 3 to add, 0 to change, 0 to destroy.

 ------------------------------------------------------------------------

 Note: You didn't specify an "-out" parameter to save this plan, so Terraform
 can't guarantee that exactly these actions will be performed if
 "terraform apply" is subsequently run.
</code></pre></div>    </div>
  </li>
  <li>Criar a infraestrutura virtual:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ terraform apply

 An execution plan has been generated and is shown below.
 Resource actions are indicated with the following symbols:
   + create

 Terraform will perform the following actions:

   # openstack_compute_floatingip_associate_v2.asoc-ip-publica will be created
   + resource "openstack_compute_floatingip_associate_v2" "asoc-ip-publica" {
       + floating_ip = (known after apply)
       + id          = (known after apply)
       + instance_id = (known after apply)
       + region      = (known after apply)
     }

   # openstack_compute_instance_v2.web will be created
   + resource "openstack_compute_instance_v2" "web" {
       + access_ip_v4        = (known after apply)
       + access_ip_v6        = (known after apply)
       + all_metadata        = (known after apply)
       + all_tags            = (known after apply)
       + availability_zone   = "nova"
       + flavor_id           = (known after apply)
       + flavor_name         = "m.fiap"
       + force_delete        = false
       + id                  = (known after apply)
       + image_id            = (known after apply)
       + image_name          = "cirros-0.3.5-x86_64-disk"
       + name                = "web"
       + power_state         = "active"
       + region              = (known after apply)
       + security_groups     = [
           + "default",
         ]
       + stop_before_destroy = false

       + network {
           + access_network = false
           + fixed_ip_v4    = (known after apply)
           + fixed_ip_v6    = (known after apply)
           + floating_ip    = (known after apply)
           + mac            = (known after apply)
           + name           = "private"
           + port           = (known after apply)
           + uuid           = (known after apply)
         }
     }

   # openstack_networking_floatingip_v2.ip-publica will be created
   + resource "openstack_networking_floatingip_v2" "ip-publica" {
       + address    = (known after apply)
       + all_tags   = (known after apply)
       + dns_domain = (known after apply)
       + dns_name   = (known after apply)
       + fixed_ip   = (known after apply)
       + id         = (known after apply)
       + pool       = "public"
       + port_id    = (known after apply)
       + region     = (known after apply)
       + tenant_id  = (known after apply)
     }

 Plan: 3 to add, 0 to change, 0 to destroy.

 Do you want to perform these actions?
   Terraform will perform the actions described above.
   Only 'yes' will be accepted to approve.

   Enter a value: yes

 openstack_networking_floatingip_v2.ip-publica: Creating...
 openstack_compute_instance_v2.web: Creating...
 openstack_networking_floatingip_v2.ip-publica: Creation complete after 6s [id=9ee8f0ab-1c12-4ca3-a357-2cec7843bde6]
 openstack_compute_instance_v2.web: Still creating... [10s elapsed]
 openstack_compute_instance_v2.web: Creation complete after 13s [id=1bb24176-55be-4156-913a-af062a0237df]
 openstack_compute_floatingip_associate_v2.asoc-ip-publica: Creating...
 openstack_compute_floatingip_associate_v2.asoc-ip-publica: Creation complete after 2s [id=172.24.4.5/1bb24176-55be-4156-913a-af062a0237df/]

 Apply complete! Resources: 3 added, 0 changed, 0 destroyed.

 Outputs:

 ip = 172.24.4.5
</code></pre></div>    </div>
  </li>
  <li>Mostrar os recursos criados:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ terraform show
 # openstack_compute_floatingip_associate_v2.asoc-ip-publica:
 resource "openstack_compute_floatingip_associate_v2" "asoc-ip-publica" {
     floating_ip = "172.24.4.5"
     id          = "172.24.4.5/1bb24176-55be-4156-913a-af062a0237df/"
     instance_id = "1bb24176-55be-4156-913a-af062a0237df"
     region      = "RegionOne"
 }

 # openstack_compute_instance_v2.web:
 resource "openstack_compute_instance_v2" "web" {
     access_ip_v4        = "10.0.0.6"
     access_ip_v6        = "[fdb5:7432:9bc4:0:f816:3eff:feaa:4949]"
     all_metadata        = {}
     all_tags            = []
     availability_zone   = "nova"
     flavor_id           = "a0683bcb-b937-4c75-be19-7641eceeff78"
     flavor_name         = "m.fiap"
     force_delete        = false
     id                  = "1bb24176-55be-4156-913a-af062a0237df"
     image_id            = "cd992dd3-2197-49fe-9f0e-43d783d18a5c"
     image_name          = "cirros-0.3.5-x86_64-disk"
     name                = "web"
     power_state         = "active"
     region              = "RegionOne"
     security_groups     = [
         "default",
     ]
     stop_before_destroy = false

     network {
         access_network = false
         fixed_ip_v4    = "10.0.0.6"
         fixed_ip_v6    = "[fdb5:7432:9bc4:0:f816:3eff:feaa:4949]"
         mac            = "fa:16:3e:aa:49:49"
         name           = "private"
         uuid           = "4e05e1bd-50f4-494b-aacf-07d43a37d1a1"
     }
 }

 # openstack_networking_floatingip_v2.ip-publica:
 resource "openstack_networking_floatingip_v2" "ip-publica" {
     address   = "172.24.4.5"
     all_tags  = []
     id        = "9ee8f0ab-1c12-4ca3-a357-2cec7843bde6"
     pool      = "public"
     region    = "RegionOne"
     tenant_id = "faac34f01fb2464295bcea501b18b741"
 }


 Outputs:

 ip = "172.24.4.5"
</code></pre></div>    </div>
  </li>
  <li>Mostrar o grafo dos recursos criados:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> $ terraform graph
 digraph {
         compound = "true"
         newrank = "true"
         subgraph "root" {
                 "[root] openstack_compute_floatingip_associate_v2.asoc-ip-publica (expand)" [label = "openstack_compute_floatingip_associate_v2.asoc-ip-publica", shape = "box"]
                 "[root] openstack_compute_instance_v2.web (expand)" [label = "openstack_compute_instance_v2.web", shape = "box"]
                 "[root] openstack_networking_floatingip_v2.ip-publica (expand)" [label = "openstack_networking_floatingip_v2.ip-publica", shape = "box"]
                 "[root] provider[\"registry.terraform.io/terraform-provider-openstack/openstack\"]" [label = "provider[\"registry.terraform.io/terraform-provider-openstack/openstack\"]", shape = "diamond"]
                 "[root] var.defaults" [label = "var.defaults", shape = "note"]
                 "[root] meta.count-boundary (EachMode fixup)" -&gt; "[root] openstack_compute_floatingip_associate_v2.asoc-ip-publica (expand)"
                 "[root] meta.count-boundary (EachMode fixup)" -&gt; "[root] output.ip (expand)"
                 "[root] openstack_compute_floatingip_associate_v2.asoc-ip-publica (expand)" -&gt; "[root] openstack_compute_instance_v2.web (expand)"
                 "[root] openstack_compute_floatingip_associate_v2.asoc-ip-publica (expand)" -&gt; "[root] openstack_networking_floatingip_v2.ip-publica (expand)"
                 "[root] openstack_compute_instance_v2.web (expand)" -&gt; "[root] provider[\"registry.terraform.io/terraform-provider-openstack/openstack\"]"
                 "[root] openstack_compute_instance_v2.web (expand)" -&gt; "[root] var.defaults"
                 "[root] openstack_networking_floatingip_v2.ip-publica (expand)" -&gt; "[root] provider[\"registry.terraform.io/terraform-provider-openstack/openstack\"]"
                 "[root] output.ip (expand)" -&gt; "[root] openstack_networking_floatingip_v2.ip-publica (expand)"
                 "[root] provider[\"registry.terraform.io/terraform-provider-openstack/openstack\"] (close)" -&gt; "[root] openstack_compute_floatingip_associate_v2.asoc-ip-publica (expand)"
                 "[root] root" -&gt; "[root] meta.count-boundary (EachMode fixup)"
                 "[root] root" -&gt; "[root] provider[\"registry.terraform.io/terraform-provider-openstack/openstack\"] (close)"
         }
 }
</code></pre></div>    </div>
  </li>
  <li>Validar a criação da instância:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>$ source devstack/openrc admin
WARNING: setting legacy OS_TENANT_NAME to support cli tools.
    
$ openstack server list
+--------------------------------------+------+--------+--------------------------------------------------------------------+--------------------------+--------+
| ID                                   | Name | Status | Networks                                                           | Image                    | Flavor |
+--------------------------------------+------+--------+--------------------------------------------------------------------+--------------------------+--------+
| 1bb24176-55be-4156-913a-af062a0237df | web  | ACTIVE | private=fdb5:7432:9bc4:0:f816:3eff:feaa:4949, 10.0.0.6, 172.24.4.5 | cirros-0.3.5-x86_64-disk | m.fiap |
+--------------------------------------+------+--------+--------------------------------------------------------------------+--------------------------+--------+
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="clean-up"><em>Clean-up</em></h2>

<ol>
  <li>Deletar o plano:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>$ terraform destroy
openstack_networking_floatingip_v2.ip-publica: Refreshing state... [id=9ee8f0ab-1c12-4ca3-a357-2cec7843bde6]
openstack_compute_instance_v2.web: Refreshing state... [id=1bb24176-55be-4156-913a-af062a0237df]
openstack_compute_floatingip_associate_v2.asoc-ip-publica: Refreshing state... [id=172.24.4.5/1bb24176-55be-4156-913a-af062a0237df/]

An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
  - destroy

Terraform will perform the following actions:

  # openstack_compute_floatingip_associate_v2.asoc-ip-publica will be destroyed
  - resource "openstack_compute_floatingip_associate_v2" "asoc-ip-publica" {
      - floating_ip = "172.24.4.5" -&gt; null
      - id          = "172.24.4.5/1bb24176-55be-4156-913a-af062a0237df/" -&gt; null
      - instance_id = "1bb24176-55be-4156-913a-af062a0237df" -&gt; null
      - region      = "RegionOne" -&gt; null
    }

  # openstack_compute_instance_v2.web will be destroyed
  - resource "openstack_compute_instance_v2" "web" {
      - access_ip_v4        = "10.0.0.6" -&gt; null
      - access_ip_v6        = "[fdb5:7432:9bc4:0:f816:3eff:feaa:4949]" -&gt; null
      - all_metadata        = {} -&gt; null
      - all_tags            = [] -&gt; null
      - availability_zone   = "nova" -&gt; null
      - flavor_id           = "a0683bcb-b937-4c75-be19-7641eceeff78" -&gt; null
      - flavor_name         = "m.fiap" -&gt; null
      - force_delete        = false -&gt; null
      - id                  = "1bb24176-55be-4156-913a-af062a0237df" -&gt; null
      - image_id            = "cd992dd3-2197-49fe-9f0e-43d783d18a5c" -&gt; null
      - image_name          = "cirros-0.3.5-x86_64-disk" -&gt; null
      - name                = "web" -&gt; null
      - power_state         = "active" -&gt; null
      - region              = "RegionOne" -&gt; null
      - security_groups     = [
          - "default",
        ] -&gt; null
      - stop_before_destroy = false -&gt; null
      - tags                = [] -&gt; null

      - network {
          - access_network = false -&gt; null
          - fixed_ip_v4    = "10.0.0.6" -&gt; null
          - fixed_ip_v6    = "[fdb5:7432:9bc4:0:f816:3eff:feaa:4949]" -&gt; null
          - mac            = "fa:16:3e:aa:49:49" -&gt; null
          - name           = "private" -&gt; null
          - uuid           = "4e05e1bd-50f4-494b-aacf-07d43a37d1a1" -&gt; null
        }
    }

  # openstack_networking_floatingip_v2.ip-publica will be destroyed
  - resource "openstack_networking_floatingip_v2" "ip-publica" {
      - address   = "172.24.4.5" -&gt; null
      - all_tags  = [] -&gt; null
      - fixed_ip  = "10.0.0.6" -&gt; null
      - id        = "9ee8f0ab-1c12-4ca3-a357-2cec7843bde6" -&gt; null
      - pool      = "public" -&gt; null
      - port_id   = "d8349f6e-8663-4bd0-b92e-04beed2b58b1" -&gt; null
      - region    = "RegionOne" -&gt; null
      - tags      = [] -&gt; null
      - tenant_id = "faac34f01fb2464295bcea501b18b741" -&gt; null
    }

Plan: 0 to add, 0 to change, 3 to destroy.

Changes to Outputs:
  - ip = "172.24.4.5" -&gt; null

Do you really want to destroy all resources?
  Terraform will destroy all your managed infrastructure, as shown above.
  There is no undo. Only 'yes' will be accepted to confirm.

  Enter a value: yes

openstack_compute_floatingip_associate_v2.asoc-ip-publica: Destroying... [id=172.24.4.5/1bb24176-55be-4156-913a-af062a0237df/]
openstack_compute_floatingip_associate_v2.asoc-ip-publica: Destruction complete after 2s
openstack_networking_floatingip_v2.ip-publica: Destroying... [id=9ee8f0ab-1c12-4ca3-a357-2cec7843bde6]
openstack_compute_instance_v2.web: Destroying... [id=1bb24176-55be-4156-913a-af062a0237df]
openstack_networking_floatingip_v2.ip-publica: Destruction complete after 6s
openstack_compute_instance_v2.web: Still destroying... [id=1bb24176-55be-4156-913a-af062a0237df, 10s elapsed]
openstack_compute_instance_v2.web: Destruction complete after 10s

Destroy complete! Resources: 3 destroyed.
</code></pre></div>    </div>
  </li>
  <li>Conferir que a VM foi deletada:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>$ openstack server list

$
</code></pre></div>    </div>
  </li>
</ol>

<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&type=follow&count=true&size=large" frameborder="0" scrolling="0" width="230" height="30" title="GitHub"></iframe>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#classes" class="page__taxonomy-item p-category" rel="tag">classes</a><span class="sep">, </span>
    
      <a href="/tags/#fiap" class="page__taxonomy-item p-category" rel="tag">fiap</a><span class="sep">, </span>
    
      <a href="/tags/#iac" class="page__taxonomy-item p-category" rel="tag">iac</a><span class="sep">, </span>
    
      <a href="/tags/#openstack" class="page__taxonomy-item p-category" rel="tag">openstack</a><span class="sep">, </span>
    
      <a href="/tags/#pt" class="page__taxonomy-item p-category" rel="tag">pt</a><span class="sep">, </span>
    
      <a href="/tags/#redhat" class="page__taxonomy-item p-category" rel="tag">redhat</a><span class="sep">, </span>
    
      <a href="/tags/#series" class="page__taxonomy-item p-category" rel="tag">series</a><span class="sep">, </span>
    
      <a href="/tags/#terraform" class="page__taxonomy-item p-category" rel="tag">terraform</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2018-05-04">May 4, 2018</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?text=OpenStack+series+VIII%3A+Terraform%20https%3A%2F%2Fjosecastillolema.github.io%2Fopenstack8-terraform%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fjosecastillolema.github.io%2Fopenstack8-terraform%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://josecastillolema.github.io/openstack8-terraform/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/openstack7-heat/" class="pagination--pager" title="OpenStack series VII: Heat - Orchestration Service">Previous</a>
    
    
      <a href="/openstackday/" class="pagination--pager" title="OpenStack Day SP 2018">Next</a>
    
  </nav>


    </div>

    
      
        <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

      
    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/podman-wasm-libkrun/" rel="permalink">Playing with Podman crun backends: Wasm(Edge) and libkrun
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          19 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Thanks to crun we can run WebAssembly (Wasm) and libkrun workloads in directly in Podman.
$ podman info | grep crun -A 2
    name: crun
    package: crun-1.1...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/newyear25/" rel="permalink">Happy new year!
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/instructlab/" rel="permalink">InstructLab: Democratizing AI Models at Scale (DL01001G)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/fp-madrid-ocaml/" rel="permalink">OCaml (vs Python) y Unikernels con MirageOS
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/josecastillolema" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/jose-castillo-lema" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://stackoverflow.com/users/4288758/jos%c3%a9-castillo-lema" rel="nofollow noopener noreferrer"><i class="fab fa-stack-overflow" aria-hidden="true"></i> Stack Overflow</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">© 2025 <a href="https://josecastillolema.github.io">GitOps</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'G-1EBHNQEGXG']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://josecastillolema.github.io/openstack8-terraform/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/openstack8-terraform"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-josecastillolema-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>


  





  </body>
</html>
