<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>IaC series: Terraform na AWS - GitOps</title>
<meta name="description" content="Serie de artigos sobre Infraestructure as a Code (IaC).">


  <meta name="author" content="Jose Castillo Lema">
  
  <meta property="article:author" content="Jose Castillo Lema">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="GitOps">
<meta property="og:title" content="IaC series: Terraform na AWS">
<meta property="og:url" content="https://josecastillolema.github.io/iac-terraform-aws/">


  <meta property="og:description" content="Serie de artigos sobre Infraestructure as a Code (IaC).">



  <meta property="og:image" content="https://josecastillolema.github.io/assets/images/favicon_io/android-chrome-512x512.png">





  <meta property="article:published_time" content="2022-03-21T00:00:00-05:00">



  <meta property="article:modified_time" content="2022-03-21T00:00:00-05:00">




<link rel="canonical" href="https://josecastillolema.github.io/iac-terraform-aws/">







  <meta name="google-site-verification" content="googled48a6d8a28aaa375.html" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="GitOps Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="shortcut icon" type="image/png" href="/assets/images/favicon.ico">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/favicon_io/android-chrome-192x192.png" alt="GitOps"></a>
        
        <a class="site-title" href="/">
          GitOps
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/series/"
                
                
              >series</a>
            </li><li class="masthead__menu-item">
              <a
                href="/classes/"
                
                
              >classes</a>
            </li><li class="masthead__menu-item">
              <a
                href="/talks/"
                
                
              >talks</a>
            </li><li class="masthead__menu-item">
              <a
                href="/tags/"
                
                
              >tags</a>
            </li><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >about</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <script lang="javascript" src="/assets/js/vanilla-back-to-top.min.js"></script>
    <script>addBackToTop({
      backgroundColor: '#6F777D',
      textColor: '#fff'
    })</script>

    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://josecastillolema.github.io/">
        <img src="/assets/images/me.jpg" alt="Jose Castillo Lema" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://josecastillolema.github.io/" itemprop="url">Jose Castillo Lema</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Software Engineer @ <strong>RedHat</strong></p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Santiago, Spain</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/josecastillolema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/jose-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://www.youracclaim.com/users/jose-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-angle-double-up" aria-hidden="true"></i><span class="label">Acclaim</span></a></li>
          
        
          
            <li><a href="https://stackoverflow.com/users/4288758/jos%c3%a9-castillo-lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">StackOverflow</span></a></li>
          
        
          
            <li><a href="https://www.researchgate.net/profile/Jose_Castillo-Lema" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-researchgate" aria-hidden="true"></i><span class="label">ResearchGate</span></a></li>
          
        
          
            <li><a href="https://scholar.google.com.br/citations?user=_xNpHiwAAAAJ" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-google" aria-hidden="true"></i><span class="label">GoogleScholar</span></a></li>
          
        
          
            <li><a href="https://www.opennetworking.org/ambassadors/jose-castillo-lema/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-battle-net" aria-hidden="true"></i><span class="label">ONF</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/channel/UCm5egt_lHxJX-VQdkLPszog/playlists" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube-square" aria-hidden="true"></i><span class="label">YouTube</span></a></li>
          
        
          
            <li><a href="https://josecastillolema.github.io/feed.xml" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i><span class="label">RSS</span></a></li>
          
        
          
            <li><a href="mailto:josecastillolema@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="IaC series: Terraform na AWS">
    <meta itemprop="description" content="Serie de artigos sobre Infraestructure as a Code (IaC).">
    <meta itemprop="datePublished" content="2022-03-21T00:00:00-05:00">
    <meta itemprop="dateModified" content="2022-03-21T00:00:00-05:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://josecastillolema.github.io/iac-terraform-aws/" itemprop="url">IaC series: Terraform na AWS
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          31 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#lab-14---terraform">Lab 14 - Terraform</a><ul><li><a href="#aws-provider">AWS Provider</a></li><li><a href="#pre-reqs">Pre-reqs</a></li><li><a href="#instalação">Instalação</a></li><li><a href="#uso">Uso</a></li><li><a href="#clean-up">Clean-up</a></li></ul></li></ul>
            </nav>
          </aside>
        
        <p><a href="/series/#infrastructure-as-code-iac">Serie de artigos</a> sobre Infraestructure as a Code (IaC).</p>

<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&amp;repo=fiap&amp;type=watch&amp;count=true&amp;size=large&amp;v=2" frameborder="0" scrolling="0" width="132" height="30" title="GitHub"></iframe>
<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&amp;repo=fiap&amp;type=star&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="130" height="30" title="GitHub"></iframe>
<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&amp;repo=fiap&amp;type=fork&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="170" height="30" title="GitHub"></iframe>

<h1 id="lab-14---terraform">Lab 14 - Terraform</h1>

<h2 id="aws-provider">AWS Provider</h2>

<p>O <a href="https://www.terraform.io/">Terraform</a> é uma ferramenta para construir, alterar e controlar a infraestrutura de forma segura e eficiente. O Terraform pode gerenciar provedores de serviços existentes e populares como OpenStack, Azure, AWS, Digital Ocean, entre outras, bem como soluções internas personalizadas.</p>

<p>Os arquivos de configuração do Terraform descrevem os componentes necessários para executar um único aplicativo ou todo o <em>datacenter</em>, gerando um plano de execução que descreve o que será feito para alcançar o estado desejado e, em seguida, executá-lo para construir a infraestrutura descrita. À medida que a configuração muda, o Terraform é capaz de determinar o que mudou e criar planos de execução incrementais que podem ser aplicados.</p>

<p>A infraestrutura que o Terraform pode gerenciar inclui componentes de baixo nível, como instâncias de computação, armazenamento e redes, bem como componentes de alto nível, como entradas DNS, recursos SaaS, etc.</p>

<p>Com relação a ferramenta podemos comparar o Terraform com o CloudFormation da AWS.</p>

<h2 id="pre-reqs">Pre-reqs</h2>

<ul>
  <li>
    <p>Uma VM com a imagem <code class="language-plaintext highlighter-rouge">Amazon Linux</code></p>
  </li>
  <li>
    <p>No painel da Vocareum, accessar as credenciais da conta para acesso programático:
 <img src="https://raw.githubusercontent.com/josecastillolema/fiap/master/shift/multicloud/img/d0.png" alt="" />
 <img src="https://raw.githubusercontent.com/josecastillolema/fiap/master/shift/multicloud/img/d1.png" alt="" /></p>
  </li>
  <li>Copiar as credenciais no arquivo <code class="language-plaintext highlighter-rouge">~/.aws/credentials</code> dentro da VM:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  $ cat ~/.aws/credentials 
  [default]
  aws_access_key_id=&lt;copy here&gt;
  aws_secret_access_key=&lt;copy here&gt;
  aws_session_token=&lt;copy here&gt;
</code></pre></div>    </div>
  </li>
  <li>Configuramos a região correta (ignorar o resto dos campos):
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ aws configure
 AWS Access Key ID [****************Q5QG]: 
 AWS Secret Access Key [****************aqWs]: 
 Default region name [None]: us-east-1
 Default output format [None]:
</code></pre></div>    </div>
  </li>
  <li>Listar VMs (em formato <code class="language-plaintext highlighter-rouge">json</code>):
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ aws ec2 describe-instances
 {
     "Reservations": [
         {
             "Groups": [],
             "Instances": [
                 {
                     "AmiLaunchIndex": 0,
                     "ImageId": "ami-0914bc04e5495b889",
                     "InstanceId": "i-0eea6b50a48d07613",
                     "InstanceType": "t2.micro",
                     "LaunchTime": "2020-09-18T00:17:13.000Z",
                     "Monitoring": {
                         "State": "disabled"
                     },
                     "Placement": {
                         "AvailabilityZone": "us-east-1c",
                         "GroupName": "",
                         "Tenancy": "default"
                     },
                     "PrivateDnsName": "",
                     "ProductCodes": [],
                     "PublicDnsName": "",
                     "State": {
                         "Code": 48,
                         "Name": "terminated"
                     },
                     "StateTransitionReason": "User initiated (2020-09-20 20:10:17 GMT)",
                     "Architecture": "x86_64",
                     "BlockDeviceMappings": [],
                     "ClientToken": "cb65d27a-49cb-d46d-a7ca-1b8368d22330",
                     "EbsOptimized": false,
                     "EnaSupport": true,
                     "Hypervisor": "xen",
                     "NetworkInterfaces": [],
                     "RootDeviceName": "/dev/xvda",
                     "RootDeviceType": "ebs",
                     "SecurityGroups": [],
                     "StateReason": {
                         "Code": "Client.UserInitiatedShutdown",
                         "Message": "Client.UserInitiatedShutdown: User initiated shutdown"
                     },
                     "Tags": [
                         {
                             "Key": "aws:cloudformation:stack-id",
                             "Value": "arn:aws:cloudformation:us-east-1:440730077537:stack/awseb-e-32fei49nnj-stack/35d81f30-f944-11ea-9cb6-0eb23bbe71c5"
                         },
                         {
                             "Key": "elasticbeanstalk:environment-id",
                             "Value": "e-32fei49nnj"
                         },
                         {
                             "Key": "Name",
                             "Value": "Fiapapp-env"
                         },
                         {
                             "Key": "aws:cloudformation:stack-name",
                             "Value": "awseb-e-32fei49nnj-stack"
                         },
                         {
                             "Key": "elasticbeanstalk:environment-name",
                             "Value": "Fiapapp-env"
                         },
                         {
                             "Key": "aws:autoscaling:groupName",
                             "Value": "awseb-e-32fei49nnj-stack-AWSEBAutoScalingGroup-17NY3APZ43NN7"
                         },
                         {
                             "Key": "aws:cloudformation:logical-id",
                             "Value": "AWSEBAutoScalingGroup"
                         }
                     ],
                     "VirtualizationType": "hvm",
                     "CpuOptions": {
                         "CoreCount": 1,
                         "ThreadsPerCore": 1
                     },
                     "CapacityReservationSpecification": {
                         "CapacityReservationPreference": "open"
                     },
                     "HibernationOptions": {
                         "Configured": false
                     },
                     "MetadataOptions": {
                         "State": "pending",
                         "HttpTokens": "optional",
                         "HttpPutResponseHopLimit": 1,
                         "HttpEndpoint": "enabled"
                     }
                 }
             ],
             "OwnerId": "440730077537",
             "RequesterId": "940372691376",
             "ReservationId": "r-04e5222922400810c"
         },
         {
             "Groups": [],
             "Instances": [
                 {
                     "AmiLaunchIndex": 0,
                     "ImageId": "ami-0817d428a6fb68645",
                     "InstanceId": "i-02a7e6dfe99d1f769",
                     "InstanceType": "t2.micro",
                     "KeyName": "fiap",
                     "LaunchTime": "2020-09-20T20:11:49.000Z",
                     "Monitoring": {
                         "State": "disabled"
                     },
                     "Placement": {
                         "AvailabilityZone": "us-east-1a",
                         "GroupName": "",
                         "Tenancy": "default"
                     },
                     "PrivateDnsName": "ip-172-31-40-37.ec2.internal",
                     "PrivateIpAddress": "172.31.40.37",
                     "ProductCodes": [],
                     "PublicDnsName": "ec2-18-232-70-66.compute-1.amazonaws.com",
                     "PublicIpAddress": "18.232.70.66",
                     "State": {
                         "Code": 16,
                         "Name": "running"
                     },
                     "StateTransitionReason": "",
                     "SubnetId": "subnet-17a00f48",
                     "VpcId": "vpc-7166990c",
                     "Architecture": "x86_64",
                     "BlockDeviceMappings": [
                         {
                             "DeviceName": "/dev/sda1",
                             "Ebs": {
                                 "AttachTime": "2020-09-20T20:11:49.000Z",
                                 "DeleteOnTermination": true,
                                 "Status": "attached",
                                 "VolumeId": "vol-0b8b82a6443e712cf"
                             }
                         }
                     ],
                     "ClientToken": "",
                     "EbsOptimized": false,
                     "EnaSupport": true,
                     "Hypervisor": "xen",
                     "NetworkInterfaces": [
                         {
                             "Association": {
                                 "IpOwnerId": "amazon",
                                 "PublicDnsName": "ec2-18-232-70-66.compute-1.amazonaws.com",
                                 "PublicIp": "18.232.70.66"
                             },
                             "Attachment": {
                                 "AttachTime": "2020-09-20T20:11:49.000Z",
                                 "AttachmentId": "eni-attach-00f1dc9a09492b219",
                                 "DeleteOnTermination": true,
                                 "DeviceIndex": 0,
                                 "Status": "attached"
                             },
                             "Description": "",
                             "Groups": [
                                 {
                                     "GroupName": "launch-wizard-3",
                                     "GroupId": "sg-0976be2478d3b8b08"
                                 }
                             ],
                             "Ipv6Addresses": [],
                             "MacAddress": "0e:6a:4f:ca:d5:f1",
                             "NetworkInterfaceId": "eni-09f8ba40f97bbc142",
                             "OwnerId": "440730077537",
                             "PrivateDnsName": "ip-172-31-40-37.ec2.internal",
                             "PrivateIpAddress": "172.31.40.37",
                             "PrivateIpAddresses": [
                                 {
                                     "Association": {
                                         "IpOwnerId": "amazon",
                                         "PublicDnsName": "ec2-18-232-70-66.compute-1.amazonaws.com",
                                         "PublicIp": "18.232.70.66"
                                     },
                                     "Primary": true,
                                     "PrivateDnsName": "ip-172-31-40-37.ec2.internal",
                                     "PrivateIpAddress": "172.31.40.37"
                                 }
                             ],
                             "SourceDestCheck": true,
                             "Status": "in-use",
                             "SubnetId": "subnet-17a00f48",
                             "VpcId": "vpc-7166990c",
                             "InterfaceType": "interface"
                         }
                     ],
                     "RootDeviceName": "/dev/sda1",
                     "RootDeviceType": "ebs",
                     "SecurityGroups": [
                         {
                             "GroupName": "launch-wizard-3",
                             "GroupId": "sg-0976be2478d3b8b08"
                         }
                     ],
                     "SourceDestCheck": true,
                     "VirtualizationType": "hvm",
                     "CpuOptions": {
                         "CoreCount": 1,
                         "ThreadsPerCore": 1
                     },
                     "CapacityReservationSpecification": {
                         "CapacityReservationPreference": "open"
                     },
                     "HibernationOptions": {
                         "Configured": false
                     },
                     "MetadataOptions": {
                         "State": "applied",
                         "HttpTokens": "optional",
                         "HttpPutResponseHopLimit": 1,
                         "HttpEndpoint": "enabled"
                     }
                 }
             ],
             "OwnerId": "440730077537",
             "ReservationId": "r-06e3113829e85cdc6"
         }
     ]
 }
</code></pre></div>    </div>
  </li>
  <li>Listar VMs (em formato tabela):
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ aws ec2 describe-instances --output table
 ------------------------------------------------------------------------------------------------------------------------------------------------------------------
 |                                                                        DescribeInstances                                                                       |
 +----------------------------------------------------------------------------------------------------------------------------------------------------------------+
 ||                                                                         Reservations                                                                         ||
 |+------------------------------------------------------------------+-------------------------------------------------------------------------------------------+|
 ||  OwnerId                                                         |  440730077537                                                                             ||
 ||  RequesterId                                                     |  940372691376                                                                             ||
 ||  ReservationId                                                   |  r-04e5222922400810c                                                                      ||
 |+------------------------------------------------------------------+-------------------------------------------------------------------------------------------+|
 |||                                                                          Instances                                                                         |||
 ||+-------------------------------------------------------+----------------------------------------------------------------------------------------------------+||
 |||  AmiLaunchIndex                                       |  0                                                                                                 |||
 |||  Architecture                                         |  x86_64                                                                                            |||
 |||  ClientToken                                          |  cb65d27a-49cb-d46d-a7ca-1b8368d22330                                                              |||
 |||  EbsOptimized                                         |  False                                                                                             |||
 |||  EnaSupport                                           |  True                                                                                              |||
 |||  Hypervisor                                           |  xen                                                                                               |||
 |||  ImageId                                              |  ami-0914bc04e5495b889                                                                             |||
 |||  InstanceId                                           |  i-0eea6b50a48d07613                                                                               |||
 |||  InstanceType                                         |  t2.micro                                                                                          |||
 |||  LaunchTime                                           |  2020-09-18T00:17:13.000Z                                                                          |||
 |||  PrivateDnsName                                       |                                                                                                    |||
 |||  PublicDnsName                                        |                                                                                                    |||
 |||  RootDeviceName                                       |  /dev/xvda                                                                                         |||
 |||  RootDeviceType                                       |  ebs                                                                                               |||
 |||  StateTransitionReason                                |  User initiated (2020-09-20 20:10:17 GMT)                                                          |||
 |||  VirtualizationType                                   |  hvm                                                                                               |||
 ||+-------------------------------------------------------+----------------------------------------------------------------------------------------------------+||
 ||||                                                             CapacityReservationSpecification                                                             ||||
 |||+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+|||
 ||||  CapacityReservationPreference                                                                                             |  open                       ||||
 |||+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+|||
 ||||                                                                        CpuOptions                                                                        ||||
 |||+------------------------------------------------------------------------------------------------------------------------+---------------------------------+|||
 ||||  CoreCount                                                                                                             |  1                              ||||
 ||||  ThreadsPerCore                                                                                                        |  1                              ||||
 |||+------------------------------------------------------------------------------------------------------------------------+---------------------------------+|||
 ||||                                                                    HibernationOptions                                                                    ||||
 |||+---------------------------------------------------------------------------------------------+------------------------------------------------------------+|||
 ||||  Configured                                                                                 |  False                                                     ||||
 |||+---------------------------------------------------------------------------------------------+------------------------------------------------------------+|||
 ||||                                                                      MetadataOptions                                                                     ||||
 |||+----------------------------------------------------------------------------------------------------------+-----------------------------------------------+|||
 ||||  HttpEndpoint                                                                                            |  enabled                                      ||||
 ||||  HttpPutResponseHopLimit                                                                                 |  1                                            ||||
 ||||  HttpTokens                                                                                              |  optional                                     ||||
 ||||  State                                                                                                   |  pending                                      ||||
 |||+----------------------------------------------------------------------------------------------------------+-----------------------------------------------+|||
 ||||                                                                        Monitoring                                                                        ||||
 |||+-----------------------------------------------------------------+----------------------------------------------------------------------------------------+|||
 ||||  State                                                          |  disabled                                                                              ||||
 |||+-----------------------------------------------------------------+----------------------------------------------------------------------------------------+|||
 ||||                                                                         Placement                                                                        ||||
 |||+------------------------------------------------------------------------------------------+---------------------------------------------------------------+|||
 ||||  AvailabilityZone                                                                        |  us-east-1c                                                   ||||
 ||||  GroupName                                                                               |                                                               ||||
 ||||  Tenancy                                                                                 |  default                                                      ||||
 |||+------------------------------------------------------------------------------------------+---------------------------------------------------------------+|||
 ||||                                                                           State                                                                          ||||
 |||+-------------------------------------------------------+--------------------------------------------------------------------------------------------------+|||
 ||||  Code                                                 |  48                                                                                              ||||
 ||||  Name                                                 |  terminated                                                                                      ||||
 |||+-------------------------------------------------------+--------------------------------------------------------------------------------------------------+|||
 ||||                                                                        StateReason                                                                       ||||
 |||+-----------------------+----------------------------------------------------------------------------------------------------------------------------------+|||
 ||||  Code                 |  Client.UserInitiatedShutdown                                                                                                    ||||
 ||||  Message              |  Client.UserInitiatedShutdown: User initiated shutdown                                                                           ||||
 |||+-----------------------+----------------------------------------------------------------------------------------------------------------------------------+|||
 ||||                                                                           Tags                                                                           ||||
 |||+-----------------------------------+----------------------------------------------------------------------------------------------------------------------+|||
 ||||                Key                |                                                        Value                                                         ||||
 |||+-----------------------------------+----------------------------------------------------------------------------------------------------------------------+|||
 ||||  aws:cloudformation:stack-id      |  arn:aws:cloudformation:us-east-1:440730077537:stack/awseb-e-32fei49nnj-stack/35d81f30-f944-11ea-9cb6-0eb23bbe71c5   ||||
 ||||  elasticbeanstalk:environment-id  |  e-32fei49nnj                                                                                                        ||||
 ||||  Name                             |  Fiapapp-env                                                                                                         ||||
 ||||  aws:cloudformation:stack-name    |  awseb-e-32fei49nnj-stack                                                                                            ||||
 ||||  elasticbeanstalk:environment-name|  Fiapapp-env                                                                                                         ||||
 ||||  aws:autoscaling:groupName        |  awseb-e-32fei49nnj-stack-AWSEBAutoScalingGroup-17NY3APZ43NN7                                                        ||||
 ||||  aws:cloudformation:logical-id    |  AWSEBAutoScalingGroup                                                                                               ||||
 |||+-----------------------------------+----------------------------------------------------------------------------------------------------------------------+|||
 ||                                                                         Reservations                                                                         ||
 |+------------------------------------------------------------------+-------------------------------------------------------------------------------------------+|
 ||  OwnerId                                                         |  440730077537                                                                             ||
 ||  RequesterId                                                     |                                                                                           ||
 ||  ReservationId                                                   |  r-06e3113829e85cdc6                                                                      ||
 |+------------------------------------------------------------------+-------------------------------------------------------------------------------------------+|
 |||                                                                          Instances                                                                         |||
 ||+-------------------------------------------------------+----------------------------------------------------------------------------------------------------+||
 |||  AmiLaunchIndex                                       |  0                                                                                                 |||
 |||  Architecture                                         |  x86_64                                                                                            |||
 |||  ClientToken                                          |                                                                                                    |||
 |||  EbsOptimized                                         |  False                                                                                             |||
 |||  EnaSupport                                           |  True                                                                                              |||
 |||  Hypervisor                                           |  xen                                                                                               |||
 |||  ImageId                                              |  ami-0817d428a6fb68645                                                                             |||
 |||  InstanceId                                           |  i-02a7e6dfe99d1f769                                                                               |||
 |||  InstanceType                                         |  t2.micro                                                                                          |||
 |||  KeyName                                              |  fiap                                                                                              |||
 |||  LaunchTime                                           |  2020-09-20T20:11:49.000Z                                                                          |||
 |||  PrivateDnsName                                       |  ip-172-31-40-37.ec2.internal                                                                      |||
 |||  PrivateIpAddress                                     |  172.31.40.37                                                                                      |||
 |||  PublicDnsName                                        |  ec2-18-232-70-66.compute-1.amazonaws.com                                                          |||
 |||  PublicIpAddress                                      |  18.232.70.66                                                                                      |||
 |||  RootDeviceName                                       |  /dev/sda1                                                                                         |||
 |||  RootDeviceType                                       |  ebs                                                                                               |||
 |||  SourceDestCheck                                      |  True                                                                                              |||
 |||  StateTransitionReason                                |                                                                                                    |||
 |||  SubnetId                                             |  subnet-17a00f48                                                                                   |||
 |||  VirtualizationType                                   |  hvm                                                                                               |||
 |||  VpcId                                                |  vpc-7166990c                                                                                      |||
 ||+-------------------------------------------------------+----------------------------------------------------------------------------------------------------+||
 ||||                                                                    BlockDeviceMappings                                                                   ||||
 |||+-------------------------------------------------------------------------------+--------------------------------------------------------------------------+|||
 ||||  DeviceName                                                                   |  /dev/sda1                                                               ||||
 |||+-------------------------------------------------------------------------------+--------------------------------------------------------------------------+|||
 |||||                                                                           Ebs                                                                          |||||
 ||||+-------------------------------------------------------------------+------------------------------------------------------------------------------------+||||
 |||||  AttachTime                                                       |  2020-09-20T20:11:49.000Z                                                          |||||
 |||||  DeleteOnTermination                                              |  True                                                                              |||||
 |||||  Status                                                           |  attached                                                                          |||||
 |||||  VolumeId                                                         |  vol-0b8b82a6443e712cf                                                             |||||
 ||||+-------------------------------------------------------------------+------------------------------------------------------------------------------------+||||
 ||||                                                             CapacityReservationSpecification                                                             ||||
 |||+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+|||
 ||||  CapacityReservationPreference                                                                                             |  open                       ||||
 |||+----------------------------------------------------------------------------------------------------------------------------+-----------------------------+|||
 ||||                                                                        CpuOptions                                                                        ||||
 |||+------------------------------------------------------------------------------------------------------------------------+---------------------------------+|||
 ||||  CoreCount                                                                                                             |  1                              ||||
 ||||  ThreadsPerCore                                                                                                        |  1                              ||||
 |||+------------------------------------------------------------------------------------------------------------------------+---------------------------------+|||
 ||||                                                                    HibernationOptions                                                                    ||||
 |||+---------------------------------------------------------------------------------------------+------------------------------------------------------------+|||
 ||||  Configured                                                                                 |  False                                                     ||||
 |||+---------------------------------------------------------------------------------------------+------------------------------------------------------------+|||
 ||||                                                                      MetadataOptions                                                                     ||||
 |||+----------------------------------------------------------------------------------------------------------+-----------------------------------------------+|||
 ||||  HttpEndpoint                                                                                            |  enabled                                      ||||
 ||||  HttpPutResponseHopLimit                                                                                 |  1                                            ||||
 ||||  HttpTokens                                                                                              |  optional                                     ||||
 ||||  State                                                                                                   |  applied                                      ||||
 |||+----------------------------------------------------------------------------------------------------------+-----------------------------------------------+|||
 ||||                                                                        Monitoring                                                                        ||||
 |||+-----------------------------------------------------------------+----------------------------------------------------------------------------------------+|||
 ||||  State                                                          |  disabled                                                                              ||||
 |||+-----------------------------------------------------------------+----------------------------------------------------------------------------------------+|||
 ||||                                                                     NetworkInterfaces                                                                    ||||
 |||+--------------------------------------------------------------+-------------------------------------------------------------------------------------------+|||
 ||||  Description                                                 |                                                                                           ||||
 ||||  InterfaceType                                               |  interface                                                                                ||||
 ||||  MacAddress                                                  |  0e:6a:4f:ca:d5:f1                                                                        ||||
 ||||  NetworkInterfaceId                                          |  eni-09f8ba40f97bbc142                                                                    ||||
 ||||  OwnerId                                                     |  440730077537                                                                             ||||
 ||||  PrivateDnsName                                              |  ip-172-31-40-37.ec2.internal                                                             ||||
 ||||  PrivateIpAddress                                            |  172.31.40.37                                                                             ||||
 ||||  SourceDestCheck                                             |  True                                                                                     ||||
 ||||  Status                                                      |  in-use                                                                                   ||||
 ||||  SubnetId                                                    |  subnet-17a00f48                                                                          ||||
 ||||  VpcId                                                       |  vpc-7166990c                                                                             ||||
 |||+--------------------------------------------------------------+-------------------------------------------------------------------------------------------+|||
 |||||                                                                       Association                                                                      |||||
 ||||+-----------------------------------------+--------------------------------------------------------------------------------------------------------------+||||
 |||||  IpOwnerId                              |  amazon                                                                                                      |||||
 |||||  PublicDnsName                          |  ec2-18-232-70-66.compute-1.amazonaws.com                                                                    |||||
 |||||  PublicIp                               |  18.232.70.66                                                                                                |||||
 ||||+-----------------------------------------+--------------------------------------------------------------------------------------------------------------+||||
 |||||                                                                       Attachment                                                                       |||||
 ||||+--------------------------------------------------------------+-----------------------------------------------------------------------------------------+||||
 |||||  AttachTime                                                  |  2020-09-20T20:11:49.000Z                                                               |||||
 |||||  AttachmentId                                                |  eni-attach-00f1dc9a09492b219                                                           |||||
 |||||  DeleteOnTermination                                         |  True                                                                                   |||||
 |||||  DeviceIndex                                                 |  0                                                                                      |||||
 |||||  Status                                                      |  attached                                                                               |||||
 ||||+--------------------------------------------------------------+-----------------------------------------------------------------------------------------+||||
 |||||                                                                         Groups                                                                         |||||
 ||||+----------------------------------------------------+---------------------------------------------------------------------------------------------------+||||
 |||||  GroupId                                           |  sg-0976be2478d3b8b08                                                                             |||||
 |||||  GroupName                                         |  launch-wizard-3                                                                                  |||||
 ||||+----------------------------------------------------+---------------------------------------------------------------------------------------------------+||||
 |||||                                                                   PrivateIpAddresses                                                                   |||||
 ||||+---------------------------------------------------------+----------------------------------------------------------------------------------------------+||||
 |||||  Primary                                                |  True                                                                                        |||||
 |||||  PrivateDnsName                                         |  ip-172-31-40-37.ec2.internal                                                                |||||
 |||||  PrivateIpAddress                                       |  172.31.40.37                                                                                |||||
 ||||+---------------------------------------------------------+----------------------------------------------------------------------------------------------+||||
 ||||||                                                                      Association                                                                     ||||||
 |||||+----------------------------------------+-------------------------------------------------------------------------------------------------------------+|||||
 ||||||  IpOwnerId                             |  amazon                                                                                                     ||||||
 ||||||  PublicDnsName                         |  ec2-18-232-70-66.compute-1.amazonaws.com                                                                   ||||||
 ||||||  PublicIp                              |  18.232.70.66                                                                                               ||||||
 |||||+----------------------------------------+-------------------------------------------------------------------------------------------------------------+|||||
 ||||                                                                         Placement                                                                        ||||
 |||+------------------------------------------------------------------------------------------+---------------------------------------------------------------+|||
 ||||  AvailabilityZone                                                                        |  us-east-1a                                                   ||||
 ||||  GroupName                                                                               |                                                               ||||
 ||||  Tenancy                                                                                 |  default                                                      ||||
 |||+------------------------------------------------------------------------------------------+---------------------------------------------------------------+|||
 ||||                                                                      SecurityGroups                                                                      ||||
 |||+-----------------------------------------------------+----------------------------------------------------------------------------------------------------+|||
 ||||  GroupId                                            |  sg-0976be2478d3b8b08                                                                              ||||
 ||||  GroupName                                          |  launch-wizard-3                                                                                   ||||
 |||+-----------------------------------------------------+----------------------------------------------------------------------------------------------------+|||
 ||||                                                                           State                                                                          ||||
 |||+----------------------------------------------------------------+-----------------------------------------------------------------------------------------+|||
 ||||  Code                                                          |  16                                                                                     ||||
 ||||  Name                                                          |  running                                                                                ||||
 |||+----------------------------------------------------------------+-----------------------------------------------------------------------------------------+|||
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="instalação">Instalação</h2>

<ol>
  <li>
    <p>Fazer o <em>download</em> da ferramenta:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ wget https://releases.hashicorp.com/terraform/1.0.6/terraform_1.0.6_linux_amd64.zip
 --2021-09-10 13:40:42--  https://releases.hashicorp.com/terraform/1.0.6/terraform_1.0.6_linux_amd64.zip
 Resolving releases.hashicorp.com (releases.hashicorp.com)... 199.232.65.183, 2a04:4e42:50::439
 Connecting to releases.hashicorp.com (releases.hashicorp.com)|199.232.65.183|:443... connected.
 HTTP request sent, awaiting response... 200 OK
 Length: 32677516 (31M) [application/zip]
 Saving to: ‘terraform_1.0.6_linux_amd64.zip’

 100%[============================================================&gt;] 32,677,516   112MB/s   in 0.3s   

 2021-09-10 13:40:42 (112 MB/s) - ‘terraform_1.0.6_linux_amd64.zip’ saved [32677516/32677516]
</code></pre></div>    </div>
  </li>
  <li>Descomprimir o arquivo baixado:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ unzip terraform_1.0.6_linux_amd64.zip 
 Archive:  terraform_1.0.6_linux_amd64.zip
   inflating: terraform               
</code></pre></div>    </div>
  </li>
  <li>Movimentar o executável:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo mv terraform /usr/local/bin/
</code></pre></div>    </div>
  </li>
  <li>Testar a instalação:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ terraform -h
 Usage: terraform [global options] &lt;subcommand&gt; [args]

 The available commands for execution are listed below.
 The primary workflow commands are given first, followed by
 less common or more advanced commands.

 Main commands:
   init          Prepare your working directory for other commands
   validate      Check whether the configuration is valid
   plan          Show changes required by the current configuration
   apply         Create or update infrastructure
   destroy       Destroy previously-created infrastructure

 All other commands:
   console       Try Terraform expressions at an interactive command prompt
   fmt           Reformat your configuration in the standard style
   force-unlock  Release a stuck lock on the current workspace
   get           Install or upgrade remote Terraform modules
   graph         Generate a Graphviz graph of the steps in an operation
   import        Associate existing infrastructure with a Terraform resource
   login         Obtain and save credentials for a remote host
   logout        Remove locally-stored credentials for a remote host
   output        Show output values from your root module
   providers     Show the providers required for this configuration
   refresh       Update the state to match remote systems
   show          Show the current state or a saved plan
   state         Advanced state management
   taint         Mark a resource instance as not fully functional
   test          Experimental support for module integration testing
   untaint       Remove the 'tainted' state from a resource instance
   version       Show the current Terraform version
   workspace     Workspace management

 Global options (use these before the subcommand, if any):
   -chdir=DIR    Switch to a different working directory before executing the
                 given subcommand.
   -help         Show this help output, or the help for a specified subcommand.
   -version      An alias for the "version" subcommand.
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="uso">Uso</h2>

<ol>
  <li>Baixar os <em>templates</em>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ git clone https://github.com/josecastillolema/fiap
 Cloning into 'fiap'...
 remote: Enumerating objects: 10, done.
 remote: Counting objects: 100% (10/10), done.
 remote: Compressing objects: 100% (10/10), done.
 remote: Total 3716 (delta 4), reused 0 (delta 0), pack-reused 3706
 Receiving objects: 100% (3716/3716), 44.63 MiB | 3.88 MiB/s, done.
 Resolving deltas: 100% (1862/1862), done.
 Checking connectivity... done.
    
 $ cd fiap/cld/multicloud/lab14-iaas-terraform/
</code></pre></div>    </div>
  </li>
  <li>Conferir o conteúdo do <a href="https://raw.githubusercontent.com/josecastillolema/fiap/master/cld/multicloud/lab14-iaas-terraform/main.tf">template</a>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ cat main.tf 
 terraform {
   required_providers {
     aws = {
       source  = "hashicorp/aws"
       version = "~&gt; 3.27"
     }
   }

   required_version = "&gt;= 0.14.9"
 }

 provider "aws" {
   profile = "default"
   region  = "us-east-1"
 }

 resource "aws_instance" "app_server" {
   ami           = "ami-087c17d1fe0178315"
   instance_type = "t2.micro"

   tags = {
     Name = "fiap-vm"
   }
 }
</code></pre></div>    </div>
  </li>
  <li>Inicializar o Terraform e o correspondente <em>provider</em> (plugin) de AWS:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ terraform init

 Initializing the backend...

 Initializing provider plugins...
 - Finding hashicorp/aws versions matching "~&gt; 3.27"...
 - Installing hashicorp/aws v3.58.0...
 - Installed hashicorp/aws v3.58.0 (signed by HashiCorp)

 Terraform has created a lock file .terraform.lock.hcl to record the provider
 selections it made above. Include this file in your version control repository
 so that Terraform can guarantee to make the same selections by default when
 you run "terraform init" in the future.

 Terraform has been successfully initialized!

 You may now begin working with Terraform. Try running "terraform plan" to see
 any changes that are required for your infrastructure. All Terraform commands
 should now work.

 If you ever set or change modules or backend configuration for Terraform,
 rerun this command to reinitialize your working directory. If you forget, other
 commands will detect it and remind you to do so if necessary.
</code></pre></div>    </div>
  </li>
  <li>Validar os templates:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ terraform fmt
 $ terraform validate
 Success! The configuration is valid.
</code></pre></div>    </div>
  </li>
  <li>Criar a infraestrutura virtual:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ terraform apply

 Terraform used the selected providers to generate the following execution plan. Resource actions are
 indicated with the following symbols:
   + create

 Terraform will perform the following actions:

   # aws_instance.app_server will be created
   + resource "aws_instance" "app_server" {
       + ami                                  = "ami-087c17d1fe0178315"
       + arn                                  = (known after apply)
       + associate_public_ip_address          = (known after apply)
       + availability_zone                    = (known after apply)
       + cpu_core_count                       = (known after apply)
       + cpu_threads_per_core                 = (known after apply)
       + disable_api_termination              = (known after apply)
       + ebs_optimized                        = (known after apply)
       + get_password_data                    = false
       + host_id                              = (known after apply)
       + id                                   = (known after apply)
       + instance_initiated_shutdown_behavior = (known after apply)
       + instance_state                       = (known after apply)
       + instance_type                        = "t2.micro"
       + ipv6_address_count                   = (known after apply)
       + ipv6_addresses                       = (known after apply)
       + key_name                             = (known after apply)
       + monitoring                           = (known after apply)
       + outpost_arn                          = (known after apply)
       + password_data                        = (known after apply)
       + placement_group                      = (known after apply)
       + primary_network_interface_id         = (known after apply)
       + private_dns                          = (known after apply)
       + private_ip                           = (known after apply)
       + public_dns                           = (known after apply)
       + public_ip                            = (known after apply)
       + secondary_private_ips                = (known after apply)
       + security_groups                      = (known after apply)
       + source_dest_check                    = true
       + subnet_id                            = (known after apply)
       + tags                                 = {
           + "Name" = "fiap-vm"
         }
       + tags_all                             = {
           + "Name" = "fiap-vm"
         }
       + tenancy                              = (known after apply)
       + user_data                            = (known after apply)
       + user_data_base64                     = (known after apply)
       + vpc_security_group_ids               = (known after apply)

       + capacity_reservation_specification {
           + capacity_reservation_preference = (known after apply)

           + capacity_reservation_target {
               + capacity_reservation_id = (known after apply)
             }
         }

       + ebs_block_device {
           + delete_on_termination = (known after apply)
           + device_name           = (known after apply)
           + encrypted             = (known after apply)
           + iops                  = (known after apply)
           + kms_key_id            = (known after apply)
           + snapshot_id           = (known after apply)
           + tags                  = (known after apply)
           + throughput            = (known after apply)
           + volume_id             = (known after apply)
           + volume_size           = (known after apply)
           + volume_type           = (known after apply)
         }

       + enclave_options {
           + enabled = (known after apply)
         }

       + ephemeral_block_device {
           + device_name  = (known after apply)
           + no_device    = (known after apply)
           + virtual_name = (known after apply)
         }

       + metadata_options {
           + http_endpoint               = (known after apply)
           + http_put_response_hop_limit = (known after apply)
           + http_tokens                 = (known after apply)
         }

       + network_interface {
           + delete_on_termination = (known after apply)
           + device_index          = (known after apply)
           + network_interface_id  = (known after apply)
         }

       + root_block_device {
           + delete_on_termination = (known after apply)
           + device_name           = (known after apply)
           + encrypted             = (known after apply)
           + iops                  = (known after apply)
           + kms_key_id            = (known after apply)
           + tags                  = (known after apply)
           + throughput            = (known after apply)
           + volume_id             = (known after apply)
           + volume_size           = (known after apply)
           + volume_type           = (known after apply)
         }
     }

 Plan: 1 to add, 0 to change, 0 to destroy.

 Do you want to perform these actions?
   Terraform will perform the actions described above.
   Only 'yes' will be accepted to approve.

   Enter a value: yes

 aws_instance.app_server: Creating...
 aws_instance.app_server: Still creating... [10s elapsed]
 aws_instance.app_server: Still creating... [20s elapsed]
 aws_instance.app_server: Still creating... [30s elapsed]
 aws_instance.app_server: Creation complete after 32s [id=i-0581e7619465fe0bb]

 Apply complete! Resources: 1 added, 0 changed, 0 destroyed.
</code></pre></div>    </div>
  </li>
  <li>Mostrar os recursos criados:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ terraform show
 # aws_instance.app_server:
 resource "aws_instance" "app_server" {
     ami                                  = "ami-087c17d1fe0178315"
     arn                                  = "arn:aws:ec2:us-east-1:376713914115:instance/i-0581e7619465
 fe0bb"
     associate_public_ip_address          = true
     availability_zone                    = "us-east-1a"
     cpu_core_count                       = 1
     cpu_threads_per_core                 = 1
     disable_api_termination              = false
     ebs_optimized                        = false
     get_password_data                    = false
     hibernation                          = false
     id                                   = "i-0581e7619465fe0bb"
     instance_initiated_shutdown_behavior = "stop"
     instance_state                       = "running"
     instance_type                        = "t2.micro"
     ipv6_address_count                   = 0
     ipv6_addresses                       = []
     monitoring                           = false
     primary_network_interface_id         = "eni-0a879183697c40c22"
     private_dns                          = "ip-172-31-93-139.ec2.internal"
     private_ip                           = "172.31.93.139"
     public_dns                           = "ec2-18-212-49-179.compute-1.amazonaws.com"
     public_ip                            = "18.212.49.179"
     secondary_private_ips                = []
     security_groups                      = [
         "default",
     ]
     source_dest_check                    = true
     subnet_id                            = "subnet-2a31160b"
     tags                                 = {
         "Name" = "fiap-vm"
     }
     tags_all                             = {
         "Name" = "fiap-vm"
     }
     tenancy                              = "default"
     vpc_security_group_ids               = [
         "sg-fa4580e5",
     ]

     capacity_reservation_specification {
         capacity_reservation_preference = "open"
     }

     credit_specification {
         cpu_credits = "standard"
     }

     enclave_options {
         enabled = false
     }

     metadata_options {
         http_endpoint               = "enabled"
         http_put_response_hop_limit = 1
         http_tokens                 = "optional"
     }

     root_block_device {
         delete_on_termination = true
         device_name           = "/dev/xvda"
         encrypted             = false
         iops                  = 100
         tags                  = {}
         throughput            = 0
         volume_id             = "vol-0faa94c59e6dfcc09"
         volume_size           = 8
         volume_type           = "gp2"
     }
 }
</code></pre></div>    </div>
  </li>
  <li>Validar a criação da instância:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ aws ec2 describe-instances --filters Name=tag-key,Values=Name --query "Reservations[*].Instances[*].{Instance:InstanceId,AZ:Placement.AvailabilityZone,Name:Tags[?Key=='Name']|[0].Value}" --output table
--------------------------------------------------
|                DescribeInstances               |
+-------------+-----------------------+----------+
|     AZ      |       Instance        |  Name    |
+-------------+-----------------------+----------+
|  us-east-1a |  i-0581e7619465fe0bb  |  fiap-vm |
+-------------+-----------------------+----------+
</code></pre></div>    </div>
    <p><img src="https://raw.githubusercontent.com/josecastillolema/fiap/master/cld/multicloud/img/t1.png" alt="" /></p>
  </li>
</ol>

<h2 id="clean-up"><em>Clean-up</em></h2>

<ol>
  <li>Deletar o plano:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ terraform destroy
aws_instance.app_server: Refreshing state... [id=i-0581e7619465fe0bb]

Terraform used the selected providers to generate the following execution plan. Resource actions are
indicated with the following symbols:
  - destroy

Terraform will perform the following actions:

  # aws_instance.app_server will be destroyed
  - resource "aws_instance" "app_server" {
      - ami                                  = "ami-087c17d1fe0178315" -&gt; null
      - arn                                  = "arn:aws:ec2:us-east-1:376713914115:instance/i-0581e7619465fe0bb" -&gt; null
      - associate_public_ip_address          = true -&gt; null
      - availability_zone                    = "us-east-1a" -&gt; null
      - cpu_core_count                       = 1 -&gt; null
      - cpu_threads_per_core                 = 1 -&gt; null
      - disable_api_termination              = false -&gt; null
      - ebs_optimized                        = false -&gt; null
      - get_password_data                    = false -&gt; null
      - hibernation                          = false -&gt; null
      - id                                   = "i-0581e7619465fe0bb" -&gt; null
      - instance_initiated_shutdown_behavior = "stop" -&gt; null
      - instance_state                       = "running" -&gt; null
      - instance_type                        = "t2.micro" -&gt; null
      - ipv6_address_count                   = 0 -&gt; null
      - ipv6_addresses                       = [] -&gt; null
      - monitoring                           = false -&gt; null
      - primary_network_interface_id         = "eni-0a879183697c40c22" -&gt; null
      - private_dns                          = "ip-172-31-93-139.ec2.internal" -&gt; null
      - private_ip                           = "172.31.93.139" -&gt; null
      - public_dns                           = "ec2-18-212-49-179.compute-1.amazonaws.com" -&gt; null
      - public_ip                            = "18.212.49.179" -&gt; null
      - secondary_private_ips                = [] -&gt; null
      - security_groups                      = [
          - "default",
        ] -&gt; null
      - source_dest_check                    = true -&gt; null
      - subnet_id                            = "subnet-2a31160b" -&gt; null
      - tags                                 = {
          - "Name" = "fiap-vm"
        } -&gt; null
      - tags_all                             = {
          - "Name" = "fiap-vm"
        } -&gt; null
      - tenancy                              = "default" -&gt; null
      - vpc_security_group_ids               = [
          - "sg-fa4580e5",
        ] -&gt; null

      - capacity_reservation_specification {
          - capacity_reservation_preference = "open" -&gt; null
        }

      - credit_specification {
          - cpu_credits = "standard" -&gt; null
        }

      - enclave_options {
          - enabled = false -&gt; null
        }

      - metadata_options {
          - http_endpoint               = "enabled" -&gt; null
          - http_put_response_hop_limit = 1 -&gt; null
          - http_tokens                 = "optional" -&gt; null
        }

      - root_block_device {
          - delete_on_termination = true -&gt; null
          - device_name           = "/dev/xvda" -&gt; null
          - encrypted             = false -&gt; null
          - iops                  = 100 -&gt; null
          - tags                  = {} -&gt; null
          - throughput            = 0 -&gt; null
          - volume_id             = "vol-0faa94c59e6dfcc09" -&gt; null
          - volume_size           = 8 -&gt; null
          - volume_type           = "gp2" -&gt; null
        }
    }

Plan: 0 to add, 0 to change, 1 to destroy.

Do you really want to destroy all resources?
  Terraform will destroy all your managed infrastructure, as shown above.
  There is no undo. Only 'yes' will be accepted to confirm.

  Enter a value: yes

aws_instance.app_server: Destroying... [id=i-0581e7619465fe0bb]
aws_instance.app_server: Still destroying... [id=i-0581e7619465fe0bb, 10s elapsed]
aws_instance.app_server: Still destroying... [id=i-0581e7619465fe0bb, 20s elapsed]
aws_instance.app_server: Still destroying... [id=i-0581e7619465fe0bb, 30s elapsed]
aws_instance.app_server: Destruction complete after 31s

Destroy complete! Resources: 1 destroyed.
</code></pre></div>    </div>
  </li>
</ol>

<iframe src="https://ghbtns.com/github-btn.html?user=josecastillolema&amp;type=follow&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="230" height="30" title="GitHub"></iframe>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#aws" class="page__taxonomy-item p-category" rel="tag">aws</a><span class="sep">, </span>
    
      <a href="/tags/#classes" class="page__taxonomy-item p-category" rel="tag">classes</a><span class="sep">, </span>
    
      <a href="/tags/#fiap" class="page__taxonomy-item p-category" rel="tag">fiap</a><span class="sep">, </span>
    
      <a href="/tags/#iac" class="page__taxonomy-item p-category" rel="tag">iac</a><span class="sep">, </span>
    
      <a href="/tags/#pt" class="page__taxonomy-item p-category" rel="tag">pt</a><span class="sep">, </span>
    
      <a href="/tags/#series" class="page__taxonomy-item p-category" rel="tag">series</a><span class="sep">, </span>
    
      <a href="/tags/#terraform" class="page__taxonomy-item p-category" rel="tag">terraform</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-03-21">March 21, 2022</time></p>

      </footer>

      <section class="page__share">
  <h4 class="page__share-title">Share on</h4>

  <a href="https://twitter.com/intent/tweet?text=IaC+series%3A+Terraform+na+AWS%20https%3A%2F%2Fjosecastillolema.github.io%2Fiac-terraform-aws%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fjosecastillolema.github.io%2Fiac-terraform-aws%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://josecastillolema.github.io/iac-terraform-aws/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/iac-ansible-aws/" class="pagination--pager" title="IaC series: Ansible na AWS">Previous</a>
    
    
      <a href="/mie/" class="pagination--pager" title="Microsoft Innovative Educator (MIE) programs">Next</a>
    
  </nav>


    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/lf-sigstore/" rel="permalink">Securing Your Software Supply Chain with Sigstore (LFS182)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/openshift-ai-learning/" rel="permalink">Red Hat OpenShift AI learning
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">OpenShift AI gives data scientists and developers a powerful AI/ML platform for building AI-enabled applications. Data scientists and developers can collabor...</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/physics-rhr-blog/" rel="permalink">Unleashing the potential of Function as a Service in the cloud continuum
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/favicon_io/android-chrome-512x512.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/dnfa6/" rel="permalink">Management orchestrator for a Content-Centric Network in a 6G network
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Management orchestrator for a Content-Centric Network in a 6G network

</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/josecastillolema" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/jose-castillo-lema" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://stackoverflow.com/users/4288758/jos%c3%a9-castillo-lema" rel="nofollow noopener noreferrer"><i class="fab fa-stack-overflow" aria-hidden="true"></i> Stack Overflow</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="https://josecastillolema.github.io">GitOps</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'G-1EBHNQEGXG']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://josecastillolema.github.io/iac-terraform-aws/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/iac-terraform-aws"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-josecastillolema-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
